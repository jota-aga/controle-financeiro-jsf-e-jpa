<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
 	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets" >

	<div class="conteudo">
		<ui:include src="/components/buttons/button-novo.xhtml">
			<ui:param name="bean" value="#{bean}"/>
			<ui:param name="dialog" value="dialogConta"/>
			<ui:param name="dialogWidgetVar" value="dialogContaWidgetVar"/>
		</ui:include>

		<p:dataTable id="tabelaConta" styleClass="tabela-conta"
			emptyMessage="Nenhuma conta cadastrada" value="#{bean.contas}"
			var="conta" rowKey="conta.id">
			<p:column headerText="Banco">
				<h:outputText value="#{conta.banco}" />
			</p:column>
			<p:column headerText="Tipo">
				<h:outputText value="#{conta.tipoDeConta.tipo}" />
			</p:column>
			<p:column headerText="Opções">
				<ui:include src="/components/buttons/button-editar.xhtml">
					<ui:param name="bean" value="#{bean}"/>
					<ui:param name="entidade" value="#{conta}"/>
					<ui:param name="componentesAtualizar" value="mainForm:dialogConta"/>
					<ui:param name="dialog" value="mainForm:dialogConta"/>
					<ui:param name="dialogWidgetVar" value="dialogContaWidgetVar"/>
				</ui:include>
				
				<ui:include src="/components/buttons/button-excluir.xhtml">
					<ui:param name="componentesAtualizar" value="mainForm:tabelaConta mainForm:growl"/>
					<ui:param name="bean" value="#{bean}"/>
					<ui:param name="entidade" value="#{conta}"/>
					<ui:param name="complementoMensagem" value="Conta do Tipo #{conta.tipoDeConta} do Banco #{conta.banco}"/>
				</ui:include>
				
				<p:commandButton title="Adicionar Movimentação" icon="fa fa-money"
					actionListener="#{movimentacaoBean.prepararNovo(conta)}"
					oncomplete="PF('dialogMovimentacaoWidgetVar').show()"
					process="@this" update="mainForm:dialogMovimentacao">
					<p:resetInput target="mainForm:dialogMovimentacao" />
				</p:commandButton>
				
				<p:commandButton title="Listar Movimentações"
					actionListener="#{movimentacaoBean.procurarPorDataAtualEConta(conta)}"
					update="mainForm:tabelaMovimentacao mainForm:dialogTabelaMovimentacao"
					icon="fa fa-eye"
					oncomplete="PF('dialogTabelaMovimentacaoWidgetVar').show()" />
			</p:column>
		</p:dataTable>

		<ui:include src="/components/dialog/form/dialog-form-conta.xhtml">
			<ui:param name="bean" value="#{bean}" />
		</ui:include>

		<ui:include src="/components/dialog/form/dialog-form-movimentacao.xhtml">
			<ui:param name="bean" value="#{movimentacaoBean}" />
		</ui:include>

		<ui:include src="/components/datatable/data-table-movimentacao.xhtml">
			<ui:param name="bean" value="#{movimentacaoBean}" />
		</ui:include>
	</div>
</ui:fragment>